<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Practice - Student GIG</title>
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
</head>
<body>
  <div class="dashboard">
    <aside class="sidebar">
      <div class="sidebar-header">
        <a href="index.html" class="sidebar-logo">GIG</a>
      </div>
      <nav class="sidebar-nav">
        <a href="dashboard.html" class="sidebar-link"><i class="fas fa-home"></i> Dashboard</a>
        <a href="subjects.html" class="sidebar-link"><i class="fas fa-book-open"></i> Subjects</a>
        <a href="notes.html" class="sidebar-link"><i class="fas fa-sticky-note"></i> Notes</a>
        <a href="practice.html" class="sidebar-link active"><i class="fas fa-brain"></i> Practice</a>
        <a href="tests.html" class="sidebar-link"><i class="fas fa-clipboard-check"></i> Tests</a>
        <a href="classes.html" class="sidebar-link"><i class="fas fa-video"></i> Classes</a>
        <a href="internships.html" class="sidebar-link"><i class="fas fa-briefcase"></i> Internships</a>
        <a href="profile.html" class="sidebar-link"><i class="fas fa-user"></i> Profile</a>
      </nav>
      <div class="sidebar-footer">
        <button class="btn btn-ghost" style="width: 100%;" onclick="Auth.logout()">
          <i class="fas fa-sign-out-alt"></i> Logout
        </button>
      </div>
    </aside>

    <main class="main-content">
      <div class="dashboard-header">
        <h1 class="welcome-text">Practice Questions ðŸ§ </h1>
        <p class="welcome-subtitle">Test your knowledge with MCQs and coding challenges</p>
      </div>

      <div class="practice-filters">
        <button class="filter-btn active" data-filter="all">All</button>
        <button class="filter-btn" data-filter="html">HTML</button>
        <button class="filter-btn" data-filter="css">CSS</button>
        <button class="filter-btn" data-filter="js">JavaScript</button>
        <button class="filter-btn" data-filter="python">Python</button>
      </div>

      <div class="search-container">
        <i class="fas fa-search search-icon"></i>
        <input type="text" class="search-input" placeholder="Search questions...">
      </div>

      <div id="questionsContainer">
        <!-- Questions will be rendered here -->
      </div>
    </main>
  </div>

  <script src="js/main.js"></script>
  <script>
    if (!Auth.currentUser) {
      window.location.href = 'signin.html';
    }

    const questions = [
      {
        id: 1,
        subject: 'html',
        difficulty: 'easy',
        question: 'What does HTML stand for?',
        options: [
          'Hyper Text Markup Language',
          'High Tech Modern Language',
          'Hyper Transfer Markup Language',
          'Home Tool Markup Language'
        ],
        correct: 0
      },
      {
        id: 2,
        subject: 'html',
        difficulty: 'easy',
        question: 'Which tag is used for the largest heading?',
        options: ['<h6>', '<heading>', '<h1>', '<head>'],
        correct: 2
      },
      {
        id: 3,
        subject: 'css',
        difficulty: 'easy',
        question: 'Which property is used to change text color?',
        options: ['font-color', 'text-color', 'color', 'foreground'],
        correct: 2
      },
      {
        id: 4,
        subject: 'css',
        difficulty: 'medium',
        question: 'Which display value creates a flex container?',
        options: ['display: flexbox', 'display: flex', 'display: flexible', 'display: flex-box'],
        correct: 1
      },
      {
        id: 5,
        subject: 'js',
        difficulty: 'easy',
        question: 'Which keyword declares a constant in JavaScript?',
        options: ['var', 'let', 'const', 'constant'],
        correct: 2
      },
      {
        id: 6,
        subject: 'js',
        difficulty: 'medium',
        question: 'What is the output of: typeof []',
        options: ['array', 'object', 'undefined', 'list'],
        correct: 1
      },
      {
        id: 7,
        subject: 'python',
        difficulty: 'easy',
        question: 'How do you start a comment in Python?',
        options: ['//', '/*', '#', '--'],
        correct: 2
      },
      {
        id: 8,
        subject: 'python',
        difficulty: 'medium',
        question: 'What is the output of: len("Hello")',
        options: ['4', '5', '6', 'Error'],
        correct: 1
      },
      {
        id: 9,
        subject: 'js',
        difficulty: 'hard',
        question: 'What is the result of: "5" + 3',
        options: ['8', '"53"', '53', 'Error'],
        correct: 1
      },
      {
        id: 10,
        subject: 'css',
        difficulty: 'hard',
        question: 'Which property creates smooth transitions?',
        options: ['animation', 'transform', 'transition', 'smooth'],
        correct: 2
      }
    ];

    let currentFilter = 'all';
    let answeredQuestions = JSON.parse(localStorage.getItem('answered_questions') || '{}');

    function renderQuestions() {
      const container = document.getElementById('questionsContainer');
      const filtered = currentFilter === 'all' 
        ? questions 
        : questions.filter(q => q.subject === currentFilter);
      
      container.innerHTML = filtered.map((q, index) => `
        <div class="question-card" data-id="${q.id}" data-subject="${q.subject}">
          <div class="question-header">
            <span class="question-number">Question ${index + 1}</span>
            <span class="difficulty-tag ${q.difficulty}">${q.difficulty}</span>
          </div>
          <p class="question-text">${q.question}</p>
          <div class="options-list">
            ${q.options.map((opt, i) => `
              <div class="option-item ${answeredQuestions[q.id] === i ? (i === q.correct ? 'correct' : 'incorrect') : ''} ${answeredQuestions[q.id] === q.correct && i === q.correct ? 'correct' : ''}" 
                   data-index="${i}" 
                   data-question="${q.id}"
                   data-correct="${q.correct}">
                <div class="option-radio"></div>
                <span>${opt}</span>
              </div>
            `).join('')}
          </div>
        </div>
      `).join('');

      // Add click handlers
      document.querySelectorAll('.option-item').forEach(item => {
        item.addEventListener('click', handleAnswer);
      });
    }

    function handleAnswer(e) {
      const item = e.currentTarget;
      const questionId = item.dataset.question;
      const selected = parseInt(item.dataset.index);
      const correct = parseInt(item.dataset.correct);

      if (answeredQuestions[questionId] !== undefined) return;

      answeredQuestions[questionId] = selected;
      localStorage.setItem('answered_questions', JSON.stringify(answeredQuestions));

      // Update UI
      const siblings = item.parentElement.querySelectorAll('.option-item');
      siblings.forEach((sib, i) => {
        if (i === correct) sib.classList.add('correct');
        if (i === selected && selected !== correct) sib.classList.add('incorrect');
      });

      // Update progress
      if (Auth.currentUser) {
        Auth.updateProgress('questionsAnswered', Object.keys(answeredQuestions).length);
      }

      if (selected === correct) {
        showToast('Correct! ðŸŽ‰');
      } else {
        showToast('Incorrect. Try again!', 'error');
      }
    }

    // Filter buttons
    document.querySelectorAll('.filter-btn').forEach(btn => {
      btn.addEventListener('click', function() {
        document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
        this.classList.add('active');
        currentFilter = this.dataset.filter;
        renderQuestions();
      });
    });

    renderQuestions();
  </script>
</body>
</html>
